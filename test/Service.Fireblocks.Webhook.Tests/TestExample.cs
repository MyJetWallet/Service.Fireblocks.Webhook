using System;
using NUnit.Framework;
using Service.Fireblocks.Webhook.Services;

namespace Service.Circle.Webhooks.Tests
{
    public class CryptoProviderTest
    {
        [SetUp]
        public void Setup()
        {
        }

        [Test]
        public void Test1()
        {
            var signature = Convert.FromBase64String("XuTiwzE6VOThjAO+hG7E97cfRdH+8JCXv3iLKlQhzgXNRk/RUP07ZBe0/NoXhLQrNTXqpgkghhs//oKSPSJU7uO2beEfynZgfnlAxHUY2a5zwk1eZMWY12lp2R72gBcracori8sajnegJpRI7X6ukKnABSxwKVFsz1jwzOmU3rdtLZyirJ0Wum3L9U7GIRKlZ0beVplBfhqBQVpNwNPZE6dfwwkKlebOXtTMb0g/N7YpWuHEAZs7Y/IesE+FuAH4WNfNYaEUxbDGsL9BMWAYyKrRQEiXoRmq2ZByzZFMJtvSgGgWMcHJwumxalyoW15I7yo5XmR4sRIHxNNIV5qbOABohblNJhm07dQeRnjCCZxqt3AXT6kdgdn1jkcC4wP9bOMfc/+CbBNWeQvw2p4oxiOPvEPKXC6KJEmqXpCPjnsGC6gRfzutmvybAuDqvHDg2UGCSrjt6uD3SNX+BZ+F8m478q+NlGo5JyFTny5vaqrO+ikwWYe/drBCnOVmn90101Km+pSM0qn9wC5nFAeCYV7jW6c0DNtbhKMk6flBbQBLqbzY679J5HBUGmxmBqbNHCaPjk3PyOlM9hBBigmkG9d8Zz1ybjgS62YkGYgH6BAj6To9k92iM56TaOBxZ+TZJPeMMtHdWq0EToesxceZ9iWdcssbo0t2bq7CiQW4xIc=");
            var data = Convert.FromBase64String("eyJ0eXBlIjoiVFJBTlNBQ1RJT05fQ1JFQVRFRCIsInRlbmFudElkIjoiYWI1ODkwNjQtNTZmYy01YzRhLWFhOTUtMWYzMGE2ZDJhODNhIiwidGltZXN0YW1wIjoxNjQxODI0OTEwNjQ4LCJkYXRhIjp7ImlkIjoiMWYwODZmZGEtZWJjYS00NzU5LTlhYWEtYzExMGEzNzI3ODE5IiwiY3JlYXRlZEF0IjoxNjQxODI0ODY0MDAwLCJsYXN0VXBkYXRlZCI6MTY0MTgyNDkwMDEzNSwiYXNzZXRJZCI6IkVUSF9URVNUIiwic291cmNlIjp7ImlkIjoiNTc3YWIwNDktYTY5OS01NTJiLWYzODMtN2NjY2QxYjQ1ZDgwIiwidHlwZSI6IkVYVEVSTkFMX1dBTExFVCIsIm5hbWUiOiIweDFFYWI3ZDQxMmEyNWE1ZDAwRWMzZDA0NjQ4YWE1NENlQTRhQjdlOTQiLCJzdWJUeXBlIjoiRXh0ZXJuYWwifSwiZGVzdGluYXRpb24iOnsiaWQiOiIxMSIsInR5cGUiOiJWQVVMVF9BQ0NPVU5UIiwibmFtZSI6IlNpbXBsZSBXaXRoZHJhd2FsIEFjY291bnQiLCJzdWJUeXBlIjoiIn0sImFtb3VudCI6MC4wMDEsIm5ldHdvcmtGZWUiOjAuMDAwMDQwMzA5OTY2OTc3LCJuZXRBbW91bnQiOjAuMDAxLCJzb3VyY2VBZGRyZXNzIjoiMHgxRWFiN2Q0MTJhMjVhNWQwMEVjM2QwNDY0OGFhNTRDZUE0YUI3ZTk0IiwiZGVzdGluYXRpb25BZGRyZXNzIjoiMHg1MkE2NDM0MjEzYTk5QjAzZkUxZjBDNTlCMzNkOEVDMDg4QTlGQjhEIiwiZGVzdGluYXRpb25BZGRyZXNzRGVzY3JpcHRpb24iOiIiLCJkZXN0aW5hdGlvblRhZyI6IiIsInN0YXR1cyI6IkNPTkZJUk1JTkciLCJ0eEhhc2giOiIweGI2M2I3YmI4NGI4OTE4NTk5ZmM1N2E3Y2RjZDc5NDdhYTU1NzllNjA4ZDM2MjM3ZmI1NWEwOWFjYmUzYjNjYmQiLCJzdWJTdGF0dXMiOiJQRU5ESU5HX0JMT0NLQ0hBSU5fQ09ORklSTUFUSU9OUyIsInNpZ25lZEJ5IjpbXSwiY3JlYXRlZEJ5IjoiIiwicmVqZWN0ZWRCeSI6IiIsImFtb3VudFVTRCI6MywiYWRkcmVzc1R5cGUiOiIiLCJub3RlIjoiIiwiZXhjaGFuZ2VUeElkIjoiIiwicmVxdWVzdGVkQW1vdW50IjowLjAwMSwiZmVlQ3VycmVuY3kiOiJFVEhfVEVTVCIsIm9wZXJhdGlvbiI6IlRSQU5TRkVSIiwiY3VzdG9tZXJSZWZJZCI6bnVsbCwibnVtT2ZDb25maXJtYXRpb25zIjoxLCJhbW91bnRJbmZvIjp7ImFtb3VudCI6IjAuMDAxIiwicmVxdWVzdGVkQW1vdW50IjoiMC4wMDEiLCJuZXRBbW91bnQiOiIwLjAwMSIsImFtb3VudFVTRCI6IjMuMDAifSwiZmVlSW5mbyI6eyJuZXR3b3JrRmVlIjoiMC4wMDAwNDAzMDk5NjY5NzcifSwiZGVzdGluYXRpb25zIjpbXSwiZXh0ZXJuYWxUeElkIjpudWxsLCJibG9ja0luZm8iOnsiYmxvY2tIZWlnaHQiOiIxMTc4OTQ5NSIsImJsb2NrSGFzaCI6IjB4NzI3Njg0ODcxMWEzZDM1ODU3MzYyNDk1YmFlY2VhZGY4N2I1NzViNzdlNzE4NmE0OGFjOTc0M2NlZDQyZTMxNCJ9LCJzaWduZWRNZXNzYWdlcyI6W10sImluZGV4IjowfX0=");

            var isVerified =  CryptoProvider.VerifySignature(data, signature);

            Assert.True(isVerified);
        }
    }
}
