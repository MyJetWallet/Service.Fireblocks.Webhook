using System;
using NUnit.Framework;
using Service.Fireblocks.Webhook.Services;

namespace Service.Circle.Webhooks.Tests
{
    public class CryptoProviderTest
    {
        [SetUp]
        public void Setup()
        {
        }

        [Test]
        public void Test1()
        {
            var signature = Convert.FromBase64String("XuTiwzE6VOThjAO+hG7E97cfRdH+8JCXv3iLKlQhzgXNRk/RUP07ZBe0/NoXhLQrNTXqpgkghhs//oKSPSJU7uO2beEfynZgfnlAxHUY2a5zwk1eZMWY12lp2R72gBcracori8sajnegJpRI7X6ukKnABSxwKVFsz1jwzOmU3rdtLZyirJ0Wum3L9U7GIRKlZ0beVplBfhqBQVpNwNPZE6dfwwkKlebOXtTMb0g/N7YpWuHEAZs7Y/IesE+FuAH4WNfNYaEUxbDGsL9BMWAYyKrRQEiXoRmq2ZByzZFMJtvSgGgWMcHJwumxalyoW15I7yo5XmR4sRIHxNNIV5qbOABohblNJhm07dQeRnjCCZxqt3AXT6kdgdn1jkcC4wP9bOMfc/+CbBNWeQvw2p4oxiOPvEPKXC6KJEmqXpCPjnsGC6gRfzutmvybAuDqvHDg2UGCSrjt6uD3SNX+BZ+F8m478q+NlGo5JyFTny5vaqrO+ikwWYe/drBCnOVmn90101Km+pSM0qn9wC5nFAeCYV7jW6c0DNtbhKMk6flBbQBLqbzY679J5HBUGmxmBqbNHCaPjk3PyOlM9hBBigmkG9d8Zz1ybjgS62YkGYgH6BAj6To9k92iM56TaOBxZ+TZJPeMMtHdWq0EToesxceZ9iWdcssbo0t2bq7CiQW4xIc=");
            var data = Convert.FromBase64String("eyJ0eXBlIjoiVFJBTlNBQ1RJT05fQ1JFQVRFRCIsInRlbmFudElkIjoiYWI1ODkwNjQtNTZmYy01YzRhLWFhOTUtMWYzMGE2ZDJhODNhIiwidGltZXN0YW1wIjoxNjQxODI0OTEwNjQ4LCJkYXRhIjp7ImlkIjoiMWYwODZmZGEtZWJjYS00NzU5LTlhYWEtYzExMGEzNzI3ODE5IiwiY3JlYXRlZEF0IjoxNjQxODI0ODY0MDAwLCJsYXN0VXBkYXRlZCI6MTY0MTgyNDkwMDEzNSwiYXNzZXRJZCI6IkVUSF9URVNUIiwic291cmNlIjp7ImlkIjoiNTc3YWIwNDktYTY5OS01NTJiLWYzODMtN2NjY2QxYjQ1ZDgwIiwidHlwZSI6IkVYVEVSTkFMX1dBTExFVCIsIm5hbWUiOiIweDFFYWI3ZDQxMmEyNWE1ZDAwRWMzZDA0NjQ4YWE1NENlQTRhQjdlOTQiLCJzdWJUeXBlIjoiRXh0ZXJuYWwifSwiZGVzdGluYXRpb24iOnsiaWQiOiIxMSIsInR5cGUiOiJWQVVMVF9BQ0NPVU5UIiwibmFtZSI6IlNpbXBsZSBXaXRoZHJhd2FsIEFjY291bnQiLCJzdWJUeXBlIjoiIn0sImFtb3VudCI6MC4wMDEsIm5ldHdvcmtGZWUiOjAuMDAwMDQwMzA5OTY2OTc3LCJuZXRBbW91bnQiOjAuMDAxLCJzb3VyY2VBZGRyZXNzIjoiMHgxRWFiN2Q0MTJhMjVhNWQwMEVjM2QwNDY0OGFhNTRDZUE0YUI3ZTk0IiwiZGVzdGluYXRpb25BZGRyZXNzIjoiMHg1MkE2NDM0MjEzYTk5QjAzZkUxZjBDNTlCMzNkOEVDMDg4QTlGQjhEIiwiZGVzdGluYXRpb25BZGRyZXNzRGVzY3JpcHRpb24iOiIiLCJkZXN0aW5hdGlvblRhZyI6IiIsInN0YXR1cyI6IkNPTkZJUk1JTkciLCJ0eEhhc2giOiIweGI2M2I3YmI4NGI4OTE4NTk5ZmM1N2E3Y2RjZDc5NDdhYTU1NzllNjA4ZDM2MjM3ZmI1NWEwOWFjYmUzYjNjYmQiLCJzdWJTdGF0dXMiOiJQRU5ESU5HX0JMT0NLQ0hBSU5fQ09ORklSTUFUSU9OUyIsInNpZ25lZEJ5IjpbXSwiY3JlYXRlZEJ5IjoiIiwicmVqZWN0ZWRCeSI6IiIsImFtb3VudFVTRCI6MywiYWRkcmVzc1R5cGUiOiIiLCJub3RlIjoiIiwiZXhjaGFuZ2VUeElkIjoiIiwicmVxdWVzdGVkQW1vdW50IjowLjAwMSwiZmVlQ3VycmVuY3kiOiJFVEhfVEVTVCIsIm9wZXJhdGlvbiI6IlRSQU5TRkVSIiwiY3VzdG9tZXJSZWZJZCI6bnVsbCwibnVtT2ZDb25maXJtYXRpb25zIjoxLCJhbW91bnRJbmZvIjp7ImFtb3VudCI6IjAuMDAxIiwicmVxdWVzdGVkQW1vdW50IjoiMC4wMDEiLCJuZXRBbW91bnQiOiIwLjAwMSIsImFtb3VudFVTRCI6IjMuMDAifSwiZmVlSW5mbyI6eyJuZXR3b3JrRmVlIjoiMC4wMDAwNDAzMDk5NjY5NzcifSwiZGVzdGluYXRpb25zIjpbXSwiZXh0ZXJuYWxUeElkIjpudWxsLCJibG9ja0luZm8iOnsiYmxvY2tIZWlnaHQiOiIxMTc4OTQ5NSIsImJsb2NrSGFzaCI6IjB4NzI3Njg0ODcxMWEzZDM1ODU3MzYyNDk1YmFlY2VhZGY4N2I1NzViNzdlNzE4NmE0OGFjOTc0M2NlZDQyZTMxNCJ9LCJzaWduZWRNZXNzYWdlcyI6W10sImluZGV4IjowfX0=");

            var isVerified =  CryptoProvider.VerifySignature(data, signature);

            Assert.True(isVerified);
        }

        //[Test]
        //public void Test2()
        //{
        //    var signature = Convert.FromBase64String("bfYZRz3SCSrDxvsZB0aTpz1t\u002BCijIb9GnOg6y9IZJ0nWnlg5qmU8d2JJ58O1xcrO\u002BRwZd\u002BkG3JMWN03W0LUedTA\u002B33lGj9q6UnIot\u002BcG9T5vZsGHFASwbkFL1tG4\u002BHWMx4xw\u002BhOUDvLU5maEyMGhe3rmyIXnlOqi8hgP/uK58gDsguOCjkOk575QFX8ITqT6uqRTPLmXOr6YJFwJqkoefaPSNoke55MRqva6BcaMxm582M5IvOjOu1hpprgrVlXBt6tAewK/8eKbbDrZbUVynwcSz\u002BFtsKs6awquiqe2yZ9073ZsWPkBVp2nQUyl46dwwgWcHWMv2yGu5O7qRfoFD3t2qpPg6o7X7xRssn8wvugX3BqncjEVkEekJja//9Hb74xrRbc4wiSZqGAndXtd1eCMIdEQLCPq6dZlLiZzSm6Dcy6OhHTR9FwRefpL1P\u002B4BTvY\u002BBGEO5OhVjY\u002Bz3FkRA76B6svyAM3kEbzuikBcrqLOmUO6M/jQOIW5LRdrYz9y3nGm1dCm\u002BgLzIYZ\u002BKGs\u002BL/V775mQHP8hbDTQC\u002BGp3BeW7C8Yg784KMJyh5o3d77rYrw1mHdPoMWdzPq\u002Bp7x7d1a5iZxuvpbC\u002BX5ctD1jMzC/NhyAGF4kDiZw/XgOL7RtqFM25opA2HbI/atBfWzDcI\u002B544RcIZUKJcNX\u002BkEIjc=");
        //    var data = Convert.FromBase64String("eyJ0eXBlIjoiVkFVTFRfQUNDT1VOVF9BU1NFVF9BRERFRCIsInRlbmFudElkIjoiZjNlYjdjYzktZjc2ZC01MDU2LWIyYmQtODE5NDc1ZWI4YjA2IiwidGltZXN0YW1wIjoxNjQyMDEzNTU2MzE5LCJkYXRhIjp7ImFjY291bnRJZCI6IjgiLCJhY2NvdW50TmFtZSI6InRlc3QtMSIsImFzc2V0SWQiOiJCVEMifX0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==");

        //    var isVerified = CryptoProvider.VerifySignature(data, signature);

        //    Assert.True(isVerified);
        //}
    }
}
